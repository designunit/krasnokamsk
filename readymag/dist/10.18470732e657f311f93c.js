(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{RnhZ:function(e,t,n){var r={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id="RnhZ"},b1Nn:function(e,t,n){"use strict";n.r(t);var r,a=n("q1tI"),i=n.n(a),o=n("i8i4"),s=n.n(o),c=n("iC7s");function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.ToggleSettingsSidebar="toggleSettingsSidebar",e.ToggleTrash="toggleTrash",e.TogglePageSettings="togglePageSettings",e.OpenSettingsForPage="openSettingsForPage",e.ClosePageSettings="closePageSettings",e.SetCurrentPageNum="setCurrentPageNum",e.TogglePageSelection="togglePageSelection"}(r||(r={}));var p=i.a.createContext({}),f=function(e){var t=e.magModel,n=e.router,o=e.children,s={isSettingsOpened:!1,isTrashOpened:!1,isPageSettingsOpened:!1,currentPageNum:n.workspace.getPageNum(),selectedPages:{}},c=function(e,t){var n=d({},e.selectedPages);return n[t]?delete n[t]:n[t]=!0,n},u=l(Object(a.useReducer)((function(e,t){switch(t.type){case r.ToggleSettingsSidebar:return d({},e,{isSettingsOpened:!e.isSettingsOpened});case r.ToggleTrash:return d({},e,{isTrashOpened:!e.isTrashOpened});case r.TogglePageSettings:return d({},e,{isPageSettingsOpened:!e.isPageSettingsOpened});case r.SetCurrentPageNum:return d({},e,{currentPageNum:t.payload});case r.TogglePageSelection:return d({},e,{selectedPages:c(e,t.payload)});default:return e}}),s),2),g=u[0],f=u[1];return i.a.createElement(p.Provider,{value:d({},g,{dispatch:f,setPageVisibility:function(e,n){return new Promise((function(r,a){var i=t.getPage(e);i||r(),i.save({hidden:n}).done((function(e){r(e)})).fail((function(e){a(e.responseJSON)}))}))},validatePageUri:function(e,n){var r=t.getPage(e);return r?r.validate({uri:n}):{pageNotFound:!0}}})},o)},m=function(e,t,n,r){var a=n.findIndex((function(t){return t.num===e})),i=a>=0?n[a]:null,o=e+1;if(i&&i.children&&i.children.length&&r[i._id]&&!r[i._id].collapsed){var s=n[a+1];o=s?s.num:i.children[i.children.length-1].num+1}var c=null;if(i&&i.children&&i.children.length&&r[i._id]&&r[i._id].collapsed)c=i._id;else if(!i){var l=t.find((function(t){return t.num===e}));l&&(c=l.parentPage)}return{newPageNum:o,newPageParentId:c}},h=n("za5s"),b=n("vOnD"),y=b.d.button.withConfig({displayName:"question-button__StyledButton"})(["padding:0;background:transparent;border:0;border-image:none;outline:none;cursor:pointer;"]),v=function(e){var t=e.onClick;return i.a.createElement(y,{onClick:t},i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"6px",height:"10px",viewBox:"0 0 6 10"},i.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.a.createElement("g",{transform:"translate(-994.000000, -39.000000)",fill:"#808080",fillRule:"nonzero"},i.a.createElement("path",{d:"M994.197187,41.8300781 C994.224531,41.1308559 994.46867,40.5634787 994.929609,40.1279297 C995.390549,39.6923806 996.033121,39.4746094 996.857344,39.4746094 C997.626879,39.4746094 998.250896,39.6796854 998.729414,40.0898438 C999.207932,40.5000021 999.447187,41.0253874 999.447187,41.6660156 C999.447187,42.5097698 999.037035,43.1777319 998.216719,43.6699219 C997.841717,43.8925792 997.58586,44.0986319 997.449141,44.2880859 C997.312421,44.47754 997.244062,44.7207016 997.244062,45.0175781 L997.244062,45.3691406 L996.031172,45.3691406 L996.025312,44.9238281 C996.009687,44.5097636 996.091718,44.1591811 996.271406,43.8720703 C996.451095,43.5849595 996.746014,43.3183606 997.156172,43.0722656 C997.515549,42.8574208 997.765546,42.6513682 997.906172,42.4541016 C998.046798,42.256835 998.117109,42.0117202 998.117109,41.71875 C998.117109,41.3945296 997.996017,41.1279307 997.753828,40.9189453 C997.511639,40.7099599 997.19133,40.6054688 996.792891,40.6054688 C996.390545,40.6054688 996.066329,40.7158192 995.820234,40.9365234 C995.574139,41.1572277 995.437422,41.4550762 995.410078,41.8300781 L994.197187,41.8300781 Z M997.36125,47.8886719 C997.197187,48.0527352 996.980392,48.1347656 996.710859,48.1347656 C996.441327,48.1347656 996.222579,48.0527352 996.054609,47.8886719 C995.88664,47.7246086 995.802656,47.509767 995.802656,47.2441406 C995.802656,46.974608 995.88664,46.7568368 996.054609,46.5908203 C996.222579,46.4248039 996.441327,46.3417969 996.710859,46.3417969 C996.980392,46.3417969 997.198163,46.4238273 997.36418,46.5878906 C997.530196,46.7519539 997.613203,46.9707018 997.613203,47.2441406 C997.613203,47.509767 997.52922,47.7246086 997.36125,47.8886719 Z"})))))};function j(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return j=function(){return e},e}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var w=i.a.createElement("path",{d:"M11.738 1a5 5 0 00-4.35 2.5l-5.149 8.918a5 5 0 00.01 5.017l5.267 9.04a5 5 0 004.301 2.484L22.28 29a5 5 0 004.35-2.5l5.149-8.918a5 5 0 00-.01-5.017l-5.267-9.04A5 5 0 0022.2 1.04l-10.463-.04zm5.273 7.987a6.013 6.013 0 110 12.026 6.013 6.013 0 010-12.026z",stroke:"#FFF",strokeWidth:2,fill:"none",fillRule:"evenodd"}),S=Object(b.d)((function(e){return i.a.createElement("svg",O({width:34,height:30},e),w)}))(j(),h.color),P=b.d.a.withConfig({displayName:"SettingsHead___StyledA"})([".user-avatar-settings-sidebar{width:56px;height:56px;}"]),x=function(e){var t=e.projectSettingsPanel,n=Object(a.useContext)(xn);return i.a.createElement(c.g,{p:2,mb:"3px"},i.a.createElement(c.n,{alignItems:"center",justifyContent:"flex-start",position:"relative"},i.a.createElement(c.g,{width:"56px",height:"56px",mr:2,bg:"darkGray",borderRadius:"round"},i.a.createElement(P,{href:"/".concat(n.project.user.uri)},i.a.createElement(c.C,{url:n.project.user.pic,name:n.project.user.name,className:"user-avatar-settings-sidebar"}))),i.a.createElement(c.D,{size:56,color:"darkGray",onClick:function(){return t.toggle()}},i.a.createElement(S,null)),i.a.createElement(c.g,{position:"absolute",right:8,mt:"-1px"},i.a.createElement(v,{onClick:function(){}}))))},E=n("wd/R"),_=n.n(E),C=n("F/us"),k=n("wEEd"),z=n("y4v0"),T=n("OTSC"),N=Object(b.d)(c.B).withConfig({displayName:"PageScreenshot___StyledPicture"})(["border-radius:4px;opacity:",";filter:blur(",");"],(function(e){return e._css}),(function(e){return e._css2})),I=function(e){var t=e.url,n=e.opacity,r=e.blur,a=void 0!==r&&r;if(!t)return null;var o=T.default.screenshotSize(256),s=T.default.addFilenameComponent(t,o);return i.a.createElement(c.g,{width:"100%",height:"100%",position:"relative"},i.a.createElement(N,{width:"100%",height:"100%",src:s,_css:void 0!==n?n:1,_css2:a?"1px":0}),i.a.createElement(c.g,{width:"100%",height:"100%",position:"absolute",top:0,left:0}))};function D(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return D=function(){return e},e}function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var A=i.a.createElement("g",{fill:"#282828",fillRule:"evenodd"},i.a.createElement("path",{d:"M13 2a1 1 0 011 1v9a2 2 0 01-2 2H3a1 1 0 01-1-1h10a1 1 0 001-1V2z"}),i.a.createElement("path",{d:"M1 0h10a1 1 0 011 1v10a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1z"})),B=Object(b.d)((function(e){return i.a.createElement("svg",R({width:14,height:14},e),A)}))(D(),h.color);function L(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return L=function(){return e},e}function G(){return(G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var M=i.a.createElement("path",{d:"M4.482.97l6.987.028a1 1 0 01.86.496l3.518 6.037a1 1 0 01.002 1.004l-3.461 5.995a1 1 0 01-.87.5l-6.987-.028a1 1 0 01-.86-.496L.153 8.469a1 1 0 01-.002-1.004L3.612 1.47a1 1 0 01.87-.5zM8 4.969C6.31 4.969 4.94 6.326 4.94 8c0 1.674 1.37 3.031 3.06 3.031S11.06 9.674 11.06 8c0-1.674-1.37-3.031-3.06-3.031z",fill:"#282828",fillRule:"evenodd"}),F=Object(b.d)((function(e){return i.a.createElement("svg",G({width:16,height:16},e),M)}))(L(),h.color);function V(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return V=function(){return e},e}function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var W=i.a.createElement("path",{d:"M9.998 0c5.914 0 8.848 6.104 8.848 6.104.278.474.274 1.255.008 1.73 0 0-2.942 6.166-8.856 6.166-5.913 0-8.847-6.151-8.847-6.151C.873 7.37.876 6.59 1.143 6.118c0 0 2.942-6.118 8.855-6.118zM10 2a5 5 0 100 10 5 5 0 000-10zm0 2a3 3 0 110 6 3 3 0 010-6z",fill:"#282828",fillRule:"evenodd"}),Y=Object(b.d)((function(e){return i.a.createElement("svg",U({width:20,height:14},e),W)}))(V(),h.color);function H(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return H=function(){return e},e}function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Q=i.a.createElement("path",{d:"M2.121.707L5.95 4.534 9.78.707a1 1 0 011.32-.083l.093.083a1 1 0 010 1.414L7.364 5.95l3.828 3.83a1 1 0 01-1.414 1.413L5.95 7.364l-3.828 3.828a1 1 0 01-1.32.084l-.094-.084a1 1 0 010-1.414L4.534 5.95.707 2.121A1 1 0 112.121.707z",fill:"#282828",fillRule:"evenodd"}),J=Object(b.d)((function(e){return i.a.createElement("svg",X({width:12,height:12},e),Q)}))(H(),h.color);function Z(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return Z=function(){return e},e}function K(){return(K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var q=i.a.createElement("path",{d:"M18.485 1.015l.707.707a.5.5 0 010 .707l-3.094 3.095c1.835 1.68 2.748 3.58 2.748 3.58.278.474.274 1.255.008 1.73 0 0-2.942 6.166-8.856 6.166-1.635 0-3.043-.47-4.224-1.152l-2.845 2.844a.5.5 0 01-.707 0l-.707-.707a.5.5 0 010-.707l2.614-2.614c-1.988-1.74-2.978-3.815-2.978-3.815-.278-.478-.275-1.259-.008-1.731 0 0 2.942-6.118 8.855-6.118 1.762 0 3.259.541 4.493 1.302l3.287-3.287a.5.5 0 01.707 0zm-4.233 6.354l-1.48 1.481a3 3 0 01-3.922 3.922l-1.48 1.481a5 5 0 006.883-6.884zM10 5a5 5 0 00-4.087 7.88l1.45-1.45a3 3 0 014.068-4.068l1.45-1.45A4.977 4.977 0 0010 5z",fill:"#282828",fillRule:"evenodd"}),$=Object(b.d)((function(e){return i.a.createElement("svg",K({width:20,height:19},e),q)}))(Z(),h.color);function ee(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return ee=function(){return e},e}function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var ne=i.a.createElement("g",{fill:"#282828",fillRule:"evenodd"},i.a.createElement("circle",{cx:8,cy:2,r:2}),i.a.createElement("circle",{cx:2,cy:2,r:2}),i.a.createElement("circle",{cx:14,cy:2,r:2})),re=Object(b.d)((function(e){return i.a.createElement("svg",te({width:16,height:4},e),ne)}))(ee(),h.color);function ae(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return ae=function(){return e},e}function ie(){return(ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var oe=i.a.createElement("path",{d:"M7.992 12.215C7.712 16.04 0 17.142 0 24V0c0 6.985 8 8 8 12z",fill:"#282828",fillOpacity:.92,fillRule:"evenodd"}),se=Object(b.d)((function(e){return i.a.createElement("svg",ie({width:8,height:24},e),oe)}))(ae(),h.color);function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var le=Object(b.d)(c.g).withConfig({displayName:"PageListItem___StyledBox"})(["user-select:none;"]),ue=Object(b.d)(c.g).withConfig({displayName:"PageListItem___StyledBox2"})(["box-shadow:",";cursor:pointer;:hover{.page-actions-popup{opacity:",";display:",";}.page-actions-button{opacity:",";display:",";}}transform-origin:left;transform:scale(",");"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6})),de=i.a.memo((function(e){var t=e.page,n=e.gridSize,o=e.level,s=void 0===o?0:o,l=e.head,u=e.isCmdPressed,d=e.isDrag,g=void 0!==d&&d,f=Object(a.useContext)(p),m=s?16*s:s,h=ce(Object(a.useState)(t.num===f.currentPageNum),2),b=h[0],y=h[1];Object(a.useEffect)((function(){y(t.num===f.currentPageNum)}),[f.currentPageNum]);return i.a.createElement(le,{width:"192px",my:"6px",ml:"".concat(m,"px"),position:"relative",display:n===We.Standard?"block":"flex"},b?i.a.createElement(c.g,{width:"6px",height:"6px",borderRadius:"round",bg:"tomato",position:"absolute",top:n===We.Standard?60:"25px",left:"-15px",zIndex:1}):null,i.a.createElement(ue,{width:n===We.Standard?192:"88px",height:n===We.Standard?124:"56px",className:"page-list-item-picture",mb:s?1:"0px",bg:"white",borderRadius:"s",position:"relative",zIndex:1,"data-page-id":t._id,onClick:function(e){e.preventDefault();var t=e.currentTarget.dataset.pageId;t&&(u?f.dispatch({type:r.TogglePageSelection,payload:t}):(y(!0),window.RM.constructorRouter.showWorkspace({id:t})))},_css:f.selectedPages[t._id]?"0 0 0 4px #f4f4f4, 0 0 0 8px #ec520b":"0 1px 1px rgba(64, 64, 64, 0.32)",_css2:!b&&f.isPageSettingsOpened?0:1,_css3:!b&&f.isPageSettingsOpened?"none":"flex",_css4:!b&&f.isPageSettingsOpened?0:1,_css5:!b&&f.isPageSettingsOpened?"none":"block",_css6:s&&n===We.Standard?"0.9":"1"},i.a.createElement(I,{url:t.screenshot,opacity:t.hidden?.4:1}),i.a.createElement(ge,{isCurrentPage:b,pageId:t._id,isPageHidden:t.hidden,gridSize:n,hidden:!!g})),i.a.createElement(c.g,{ml:2,hidden:!!g},i.a.createElement(c.g,{width:"100%",ml:"".concat(l?16:0,"px"),mt:"".concat(n===We.Standard?6:10,"px")},i.a.createElement(c.O,{textStyle:"small"},t.num,"."),i.a.createElement(c.O,{textStyle:"small",color:t.title?"black":"darkGray"},"Â ",t.title?t.title:"Page Title")),i.a.createElement(c.g,{width:"100%",mt:"-2px"},i.a.createElement(c.O,{textStyle:"small",color:t.uri?"black":"darkGray"},t.uri?"/".concat(t.uri):"/custom url"))))}));de.displayName="PageListItem";var ge=i.a.memo((function(e){var t=e.isCurrentPage,n=e.pageId,o=e.isPageHidden,s=e.gridSize,c=e.hidden,l=void 0!==c&&c,u=Object(a.useContext)(p),d=Object(a.useContext)(xn),g=function(e){e.preventDefault(),e.stopPropagation(),d.deletePage(n)},f=function(e){e.preventDefault(),e.stopPropagation(),d.duplicatePage(n).then((function(){})).catch((function(e){console.warn("page dublicate",e)}))},m=function(e){e.preventDefault(),e.stopPropagation(),u.isTrashOpened?(u.dispatch({type:r.ToggleTrash}),setTimeout((function(){u.dispatch({type:r.TogglePageSettings})}),300)):u.dispatch({type:r.TogglePageSettings})};return l?null:s===We.Standard?i.a.createElement(ye,{isCurrentPage:t,isPageHidden:o,isPageSettingsOpened:u.isPageSettingsOpened,onPageDuplicate:f,onPageSettingsToggle:m,onPageDelete:g}):i.a.createElement(je,{isCurrentPage:t,isPageHidden:o,isPageSettingsOpened:u.isPageSettingsOpened,onPageDuplicate:f,onPageSettingsToggle:m,onPageDelete:g})}));ge.displayName="PageActionsPopup";var pe,fe=Object(b.d)(c.n).withConfig({displayName:"PageListItem___StyledFlex"})(["opacity:",";transition:opacity 200ms ease;"],(function(e){return e._css7})),me=Object(b.d)(c.D).withConfig({displayName:"PageListItem___StyledRoundButton"})(["display:",";"],(function(e){return e._css8})),he=Object(b.d)(c.D).withConfig({displayName:"PageListItem___StyledRoundButton2"})(["display:",";"],(function(e){return e._css9})),be=Object(b.d)(c.D).withConfig({displayName:"PageListItem___StyledRoundButton3"})(["display:",";"],(function(e){return e._css10})),ye=i.a.memo((function(e){var t=e.isCurrentPage,n=e.isPageHidden,r=e.isPageSettingsOpened,a=e.onPageDuplicate,o=e.onPageSettingsToggle,s=e.onPageDelete;return i.a.createElement(fe,{className:"page-actions-popup",width:177,height:34,justifyContent:"space-between",position:"absolute",bottom:7,left:7,_css7:t?"1":"0"},i.a.createElement(c.g,null,i.a.createElement(me,{size:34,color:"white",disabled:r,onClick:a,_css8:r?"none":"flex"},i.a.createElement(B,null))),i.a.createElement(c.g,null,i.a.createElement(c.D,{size:34,color:"white",onClick:o,"data-hovered":t&&r},i.a.createElement(F,null))),i.a.createElement(c.g,null,i.a.createElement(he,{size:34,color:"white",_css9:r?"none":"flex"},n?i.a.createElement($,null):i.a.createElement(Y,null))),i.a.createElement(c.g,null,i.a.createElement(be,{size:34,color:"white",onClick:s,_css10:r?"none":"flex"},i.a.createElement(J,null))))}));ye.displayName="PageActionsStandartPanel",function(e){e.Duplicate="duplicate",e.Delete="detele",e.Settings="settings"}(pe||(pe={}));var ve=Object(b.d)(c.g).withConfig({displayName:"PageListItem___StyledBox3"})(["opacity:",";transition:opacity 200ms ease;box-shadow:0 0 0 1px rgba(128,128,128,0.16);"],(function(e){return e._css11})),je=i.a.memo((function(e){var t=e.isCurrentPage,n=(e.isPageHidden,e.isPageSettingsOpened),r=e.onPageDuplicate,o=e.onPageSettingsToggle,s=e.onPageDelete,l=ce(Object(a.useState)(!1),2),u=l[0],d=l[1],g=ce(Object(a.useState)({x:0,y:0}),2),p=g[0],f=g[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(Se,{isShown:u,isPageSettingsOpened:n,coords:p,callback:function(e,t){switch(e){case pe.Duplicate:d(!1),r(t);break;case pe.Delete:d(!1),s(t);break;case pe.Settings:o(t)}}}),i.a.createElement(ve,{className:"page-actions-button",width:32,height:32,position:"absolute",top:12,left:7,borderRadius:"round",_css11:t?"1":"0"},i.a.createElement(c.D,{size:32,color:"white",onClick:function(e){return function(e){var t=e.currentTarget.getBoundingClientRect();f({x:t.x,y:t.y+t.height/2}),d(!u)}(e)}},i.a.createElement(re,null))))}));je.displayName="PageActionsSmallPanel";var Oe=Object(b.d)(c.g).withConfig({displayName:"PageListItem___StyledBox4"})(["transform:translateX(",");transition:0.3s transform ease;"],(function(e){return e._css12})),we=Object(b.d)(c.g).withConfig({displayName:"PageListItem___StyledBox5"})(["background-color:rgba(40,40,40,0.92);"]),Se=function(e){var t=e.isShown,n=e.isPageSettingsOpened,r=e.coords,a=e.callback;return t?s.a.createPortal(i.a.createElement(Oe,{position:"absolute",left:r.x-160,top:r.y-80,zIndex:8e3,_css12:n?"-240px":"0px"},i.a.createElement(we,{width:148,height:160,borderRadius:"l",bg:"black",pl:3,pt:12},i.a.createElement(c.g,null,i.a.createElement(c.h,{textStyle:"subheading",color:"white",onClick:function(e){return a(pe.Duplicate,e)}},"Duplicate")),i.a.createElement(c.g,{mt:12},i.a.createElement(c.h,{textStyle:"subheading",color:n?"tomato":"white",onClick:function(e){return a(pe.Settings,e)}},"Settings")),i.a.createElement(c.g,{mt:12},i.a.createElement(c.h,{textStyle:"subheading",color:"white"},"Show")),i.a.createElement(c.g,{mt:12},i.a.createElement(c.h,{textStyle:"subheading",color:"white",onClick:function(e){return a(pe.Delete,e)}},"Delete"))),i.a.createElement(c.n,{position:"absolute",top:68,right:-8},i.a.createElement(se,null))),document.getElementsByTagName("body")[0]):null};function Pe(){return(Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ee=Object(b.d)(c.g).withConfig({displayName:"DraggableItem___StyledBox"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);"]),_e=i.a.memo((function(e){var t=Object(a.useContext)(xn),n=Object(a.useRef)(null),r=Object(a.useRef)(null),o=xe(Object(a.useState)(null),2),c=o[0],l=o[1];Object(a.useEffect)((function(){var e=document.querySelector(".page-drag-container");e&&l(e),n.current&&n.current.dataset.pageLevel&&+n.current.dataset.pageLevel&&P(!0)}),[]);var u=xe(Object(k.c)((function(){return{x:0,y:0,config:k.b.gentle}})),2),d=u[0].y,g=u[1],p=xe(Object(a.useState)({offset:0,state:!1}),2),f=p[0],m=p[1],h=xe(Object(a.useState)(null),2),b=h[0],y=h[1],v=xe(Object(a.useState)(null),2),j=v[0],O=v[1],w=xe(Object(a.useState)(!1),2),S=w[0],P=w[1],x=function(){b&&(b.style.boxShadow="unset",y(null))},E=function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];j&&j.elem&&(T(j.elem,e),O(null))}(),document.querySelectorAll(".drag-shadow-block").forEach((function(e){e.remove()}))},_=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a=document.createElement("div");return a.className="drag-shadow-block",a.style.width=r?"172px":"192px",a.style.marginTop="6px",a.style.marginBottom="6px",a.style.marginLeft=r?"16px":"0",a.style.boxSizing="border-box",n?(a.style.height="0px",a.style.transition="height 0.2s linear 0s"):a.style.height=r?"112px":"124px",{pageId:e,position:t,elem:a}},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(e.style.transition="height 0.2s linear 0s",e.style.height="0px",setTimeout((function(){e.remove()}),200)):e.remove()},N=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=null!==a?a:S,o=_(e,n,r,i);j&&j.elem&&T(j.elem,r),n===mn.After?t.after(o.elem):t.before(o.elem),r&&setTimeout((function(){o.elem.style.height=i?"112px":"124px"}),0),O(o)},D=Object(z.a)((function(a){var i=a.down,o=xe(a.movement,2),s=o[0],c=o[1],l=a.event;if(r.current&&f.state&&R(l,r.current,c),f.state!==i){var u=t.pagesParams[e.page._id];if(u&&u.children.length&&u.collapsed)return;if(i){var d=n.current?n.current.getBoundingClientRect().top+6:0;m({offset:d,state:!0}),n.current&&(S&&(n.current.parentNode.parentNode.style.height="auto"),L())}else!function(){var n={changingId:e.page._id};if(b&&b.dataset.pageId?(n.targetId=b.dataset.pageId,n.position=mn.Inside):j&&(n.targetId=j.pageId,n.position=j.position),x(),E(),n.changingId&&n.targetId&&n.position){var r=t.getNewPageOrderElement(n);r instanceof Error?Error:t.reorderPage(e.page._id,r)}}(),m({offset:0,state:!1})}g({x:i?s:0,y:i?c:0})}),{capture:!0,filterTaps:!0,delay:100,axis:"y"}),R=function(t,n,r){n.hidden=!0;var a=document.elementFromPoint(t.clientX,t.clientY);if(n.hidden=!1,a){var i,o,s,c,l,u=a.closest(".page-list-draggable-item");if(u){if(u&&u.dataset.pageId&&u.dataset.pageId!==e.page._id){var d=u.getBoundingClientRect(),g=n.getBoundingClientRect(),p=(o=d,s=(i=g).top>=o.top&&i.top<=o.bottom,c=i.bottom>=o.top&&i.bottom<=o.bottom,l=i.top<=o.top&&i.bottom>=o.bottom,{intersect:s||c||l,middleMargin:i.bottom-i.height/2-(o.bottom-o.height/2)});A(p,u);var f=!!parseInt(u.dataset.pageLevel),m=!1;f!==S&&(m=!0,f&&(u.parentNode.parentNode.style.height="auto"),P(f)),B(j,u,p.middleMargin>=0?mn.After:mn.Before,m?f:null)}}else x()}},A=Object(C.debounce)((function(n,r){if((!r.dataset.pageLevel||!parseInt(r.dataset.pageLevel))&&(!t.pagesParams[e.page._id]||!t.pagesParams[e.page._id].children.length)&&n.intersect){var a=r.querySelector(".page-list-item-picture");a&&(b?b.dataset.pageId!==a.dataset.pageId&&(b.style.boxShadow="unset",a.style.boxShadow="0 0 0 4px #f4f4f4, 0 0 0 8px #B8B8B8",y(a)):(a.style.boxShadow="0 0 0 4px #f4f4f4, 0 0 0 8px #B8B8B8",y(a)))}}),400),B=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e?e.pageId!==t.dataset.pageId&&e.position!==n?N(t.dataset.pageId,t.parentNode,n,!1,r):e.pageId===t.dataset.pageId&&e.position===n||N(t.dataset.pageId,t.parentNode,n,!0,r):N(t.dataset.pageId,t.parentNode,n,!0,r)},L=function(){if(1===t.pages.length||e.page.parentPage&&1===t.pagesParams[e.page.parentPage].children.length)N(e.page._id,n.current.parentNode,mn.After);else{var r=t.pages.findIndex((function(t){return t._id===e.page._id})),a=t.pages[r-1];if(a&&a.parentPage===e.page.parentPage)N(a._id,n.current.parentNode.previousSibling,mn.After);else{var i=t.pages[r+1];i&&i.parentPage===e.page.parentPage?N(i._id,n.current.parentNode.nextSibling,mn.Before):N(e.page._id,n.current.parentNode,mn.After)}}};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",Pe({className:"page-list-draggable-item","data-page-id":e.page._id,"data-page-level":e.level,ref:n},D(),{style:{boxSizing:"border-box",display:f.state?"none":"block",border:"0"}}),i.a.createElement(de,e)),f.state&&c?s.a.createPortal(i.a.createElement(k.a.div,{ref:r,style:{transform:d.interpolate((function(e){return"translate(0, ".concat(e,"px)")})),zIndex:3e3,position:"absolute",top:f.offset,boxSizing:"border-box",pointerEvents:"none",userSelect:"none"}},i.a.createElement(Ee,{width:S?"172px":"192px",height:S?"112px":"124px",ml:S?"40px":"24px",bg:"white",borderRadius:"s"},i.a.createElement(I,{url:e.page.screenshot}))),c):null)}));function Ce(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return Ce=function(){return e},e}function ke(){return(ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}_e.displayName="DraggableItem";var ze=i.a.createElement("path",{d:"M4.24 6.114L.416 1.651A1 1 0 011.175 0h7.65a1 1 0 01.76 1.65L5.759 6.115a1 1 0 01-1.518 0z",fill:"#282828",fillRule:"evenodd"}),Te=Object(b.d)((function(e){return i.a.createElement("svg",ke({width:10,height:7},e),ze)}))(Ce(),h.color);function Ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ie=Object(b.d)(c.n).withConfig({displayName:"Branch___StyledFlex"})(["cursor:pointer;z-index:1;transform:rotate(",");transition:transform 200ms ease;"],(function(e){return e._css})),De=Object(b.d)(c.g).withConfig({displayName:"Branch___StyledBox"})(["height:",";overflow-x:hidden;transition:height 200ms ease;"],(function(e){return e._css2})),Re=function e(t){var n=t.page,r=t.gridSize,o=t.level,s=void 0===o?0:o,l=t.isCmdPressed,u=Object(a.useContext)(xn),d=Ne(Object(a.useState)(null),2),g=d[0],p=d[1],f=Object(a.useRef)(null),m=!(!n.children||!n.children.length),h=!u.pagesParams[n._id]||u.pagesParams[n._id].collapsed,b=n.children&&n.children.length?n.children.map((function(e){return e.num_id})).join(";"):"";Object(a.useEffect)((function(){f&&f.current&&(f.current.style.height="auto",p(f.current.scrollHeight),f.current.style.removeProperty("height"))}),[r,b]),f&&f.current&&f.current.style.removeProperty("height");return i.a.createElement(c.g,{position:"relative"},i.a.createElement(_e,{page:n,gridSize:r,level:s,head:m,isCmdPressed:l}),n.children&&m?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{width:12,height:12,position:"absolute",top:r===We.Standard?146:26,left:r===We.Standard?0:93,alignItems:"center",justifyContent:"center",onClick:function(){u.setPageCollapse(n._id,!h)},_css:h?"0deg":"-90deg"},i.a.createElement(Te,null)),i.a.createElement(De,{className:"page-children-container",ref:f,_css2:h?g?"".concat(g,"px"):"auto":"0px"},n.children.map((function(t){return t.children?i.a.createElement(e,{key:t._id,page:t,gridSize:r,level:s+1,isCmdPressed:l}):i.a.createElement(_e,{key:t._id,page:t,gridSize:r,level:s+1,isCmdPressed:l})})))):null)};function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Be=function(e){var t=e.gridSize,n=Object(a.useContext)(p),r=Object(a.useContext)(xn);Object(a.useEffect)((function(){window.RM.constructorRouter.pageOrder.fixPageOrder(window.RM.constructorRouter.mag)}),[n.isSettingsOpened]);var o=Ae(Object(a.useState)(!1),2),s=o[0],l=o[1],u=function(e){91!==e.keyCode&&17!==e.keyCode&&93!==e.keyCode||l(!0)},d=function(e){91!==e.keyCode&&17!==e.keyCode&&93!==e.keyCode||l(!1)};return Object(a.useEffect)((function(){return n.isSettingsOpened?(document.addEventListener("keydown",u),document.addEventListener("keyup",d)):(document.removeEventListener("keydown",u),document.removeEventListener("keyup",d)),function(){document.removeEventListener("keydown",u),document.removeEventListener("keyup",d)}}),[n.isSettingsOpened]),i.a.createElement(c.n,{className:"page-list-container",flexDirection:"column",justifyContent:"left",flexWrap:"wrap",px:3,py:"6px"},r.pagesTree.map((function(e){return i.a.createElement(Re,{key:e._id,page:e,isCmdPressed:s,gridSize:t})})))};function Le(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return Le=function(){return e},e}function Ge(){return(Ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Me=i.a.createElement("path",{d:"M7 7a1 1 0 011 1v3a1 1 0 01-1 1H1a1 1 0 01-1-1V8a1 1 0 011-1h6zm0-7a1 1 0 011 1v3a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1z",fill:"gray",fillRule:"evenodd"}),Fe=Object(b.d)((function(e){return i.a.createElement("svg",Ge({width:8,height:12},e),Me)}))(Le(),h.color);function Ve(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return Ve=function(){return e},e}function Ue(){return(Ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var We,Ye=i.a.createElement("rect",{width:16,height:12,rx:1,fill:"gray",fillRule:"evenodd"}),He=Object(b.d)((function(e){return i.a.createElement("svg",Ue({width:16,height:12},e),Ye)}))(Ve(),h.color);function Xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){e[e.Standard=0]="Standard",e[e.Small=1]="Small"}(We||(We={}));var Qe=Object(b.d)(c.g).withConfig({displayName:"SettingsBody___StyledBox"})(["overflow-x:visible;overflow-y:auto;"]),Je=Object(b.d)(He).withConfig({displayName:"SettingsBody___StyledStandardGridIcon"})(["cursor:pointer;rect{fill:",";}"],(function(e){return e._css})),Ze=Object(b.d)(Fe).withConfig({displayName:"SettingsBody___StyledSmallGridIcon"})(["cursor:pointer;path{fill:",";}"],(function(e){return e._css2})),Ke=function(){var e,t=Object(a.useContext)(xn),n=Xe(Object(a.useState)(We.Standard),2),r=n[0],o=n[1];return i.a.createElement(Qe,{className:"page-list-scroll-container",width:1,height:"calc(100% - 72px - 75px)",position:"relative"},i.a.createElement(c.g,{px:3},i.a.createElement(c.g,null,i.a.createElement(c.O,{color:"black",textStyle:"subheading"},t.project.title||"Project Title")),i.a.createElement(c.g,{mt:"7px",position:"relative"},i.a.createElement(c.O,{color:"darkGray",textStyle:"small"},(e=t.project).is_published?e.changed?"Unpublished changes":"Published ".concat(_()(e.published).format("MMM D, YYYY")):"Unpublished"),i.a.createElement(c.n,{mt:"14px",onClick:function(){return o((function(e){return e===We.Standard?We.Small:We.Standard}))}},i.a.createElement(c.g,null,i.a.createElement(Je,{_css:r===We.Standard?"#808080":"#B8B8B8"})),i.a.createElement(c.g,{ml:"1"},i.a.createElement(Ze,{_css2:r===We.Small?"#808080":"#B8B8B8"}))))),i.a.createElement(Be,{gridSize:r}))},qe=n("YqYG");function $e(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return $e=function(){return e},e}function et(){return(et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var tt=i.a.createElement("path",{d:"M13 0a1 1 0 011 1v11h11a1 1 0 110 2H14v11a1 1 0 11-2 0V14H1a1 1 0 010-2h11V1a1 1 0 011-1z",fill:"#282828",fillRule:"evenodd"}),nt=Object(b.d)((function(e){return i.a.createElement("svg",et({width:26,height:26},e),tt)}))($e(),h.color),rt=function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(xn),n=Object(a.useRef)(new qe.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:t.project.user?t.project.user.email:""},alert_source:"custom sharing"})).current;return i.a.createElement(c.g,{width:1,height:80,position:"absolute",left:0,bottom:0},i.a.createElement(c.h,{color:"darkGray",textStyle:"small",position:"absolute",left:24,bottom:37},"Add"),i.a.createElement(c.h,{position:"absolute",left:107,bottom:28},i.a.createElement(nt,{onClick:function(r){r.preventDefault(),t.addNewPage(e.currentPageNum).then((function(){})).catch((function(e){e&&e.err&&"permission_denied"===e.err&&n.render()}))}})),i.a.createElement(c.h,{color:e.isTrashOpened?"tomato":"darkGray",textStyle:"small",position:"absolute",right:26,bottom:37,onClick:function(n){n.preventDefault(),(t.project.has_deleted_pages||e.isTrashOpened)&&e.dispatch({type:r.ToggleTrash})}},e.isTrashOpened?"Close":"Bin"))};function at(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var it=b.d.div.withConfig({displayName:"Trash__TrashSidebar"})(["height:100%;width:240px;padding:12px 22px;box-sizing:border-box;position:fixed;top:0;right:0;bottom:0;z-index:4000;background-color:",";overflow-x:hidden;overflow-y:auto;transform:translateX( "," );transition:transform 300ms ease;"],Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isTrashOpened?"0px":"240px":e.isTrashOpened?"480px":"240px"})),ot=i.a.memo((function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(xn);Object(a.useEffect)((function(){e.isTrashOpened?(document.body.classList.add("trash-is-opened"),t.updateTrash()):document.body.classList.remove("trash-is-opened")}),[e.isTrashOpened]);var n=function(e){return t.restorePage(e)},r=function(e){return t.deletePagesFromTrash([e])};return i.a.createElement(it,{isTrashOpened:e.isTrashOpened,isSettingsOpened:e.isSettingsOpened},i.a.createElement(c.g,{height:"calc(100% - 80px)",overflow:"auto"},i.a.createElement(c.g,{mb:28},i.a.createElement(c.O,{color:"white",textStyle:"subheading",textAlign:"left"},"Deleted pages")),t.trashPages.map((function(e){return i.a.createElement(pt,{key:e._id,page:e,isOwner:t.isOwner,onRestorePage:n,onDeletePage:r})}))),t.trashPages.length?i.a.createElement(mt,{onEmptyTrash:function(){t.isOwner&&t.trashPages&&t.emptyTrash()},isOwner:t.isOwner}):null)}));ot.displayName="Trash";var st=Object(b.d)(c.g).withConfig({displayName:"Trash___StyledBox"})([":hover{.trash-page-actions{opacity:1;}}"]),ct=Object(b.d)(c.n).withConfig({displayName:"Trash___StyledFlex"})(["opacity:0;transition:opacity 200ms ease;"]),lt=Object(b.d)(c.n).withConfig({displayName:"Trash___StyledFlex2"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);"]),ut=Object(b.d)(c.n).withConfig({displayName:"Trash___StyledFlex3"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);"]),dt=Object(b.d)(c.n).withConfig({displayName:"Trash___StyledFlex4"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);"]),gt=Object(b.d)(c.n).withConfig({displayName:"Trash___StyledFlex5"})(["cursor:",";border:1px solid rgba(128,128,128,0.16);"],(function(e){return e._css})),pt=i.a.memo((function(e){var t=e.page,n=e.isOwner,r=e.onRestorePage,o=e.onDeletePage,s=at(Object(a.useState)(!1),2),l=s[0],u=s[1];return i.a.createElement(c.g,{mb:12,ml:"2px"},i.a.createElement(st,{width:192,height:124,bg:"darkGray",borderRadius:"s",position:"relative"},i.a.createElement(I,{url:t.screenshot}),i.a.createElement(ct,{className:"trash-page-actions",width:176,height:32,justifyContent:"space-between",position:"absolute",left:8,bottom:8},l?i.a.createElement(lt,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"tomato",borderRadius:"xl",onClick:function(e){e.preventDefault(),n&&o(t._id)}},i.a.createElement(c.O,{textStyle:"small",color:"white"},"Yes")):i.a.createElement(ut,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),r(t._id)}},i.a.createElement(c.O,{textStyle:"small",color:"black"},"Restore")),l?i.a.createElement(dt,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),u(!1)}},i.a.createElement(c.O,{textStyle:"small",color:"black"},"Cancel")):i.a.createElement(gt,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),u(!0)},_css:n?"pointer":"not-allowed"},i.a.createElement(c.O,{textStyle:"small",color:n?"black":"gray"},"Delete")))),i.a.createElement(c.g,{mt:"7px"},i.a.createElement(c.O,{textStyle:"small",color:"white"},t.title?t.title:"Page Title")))}));pt.displayName="TrashPage";var ft=Object(b.d)(c.h).withConfig({displayName:"Trash___StyledButton"})(["cursor:",";"],(function(e){return e._css2})),mt=i.a.memo((function(e){var t=e.onEmptyTrash,n=e.isOwner;return i.a.createElement(c.n,{height:80,justifyContent:"center",alignItems:"center",borderTop:"2px solid #B8B8B8",position:"relative",top:12},i.a.createElement(ft,{textStyle:"small",color:n?"white":"gray",onClick:t,_css2:n?"pointer":"not-allowed"},"Empty bin"))}));mt.displayName="TrashFooter";var ht=ot,bt=n("tZHv");function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(n,!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wt=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css}),(function(e){return e._css2})),St=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css3}),(function(e){return e._css4})),Pt=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel3"})(["color:",";",";"],(function(e){return e._css5}),(function(e){return e._css6})),xt=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel4"})(["color:",";",";"],(function(e){return e._css7}),(function(e){return e._css8})),Et=i.a.memo((function(e){var t=e.currentPage,n=Object(a.useContext)(p),r=Object(a.useContext)(xn),o=function(){var e={title:"",description:"",keywords:""};return t&&t.seo&&(e=jt({},e,{},t.seo)),e},s=yt(Object(a.useState)((function(){return o()})),2),l=s[0],u=s[1],d=yt(Object(a.useState)((function(){return t&&t.uri?t.uri:""})),2),g=d[0],f=d[1],m=yt(Object(a.useState)(null),2),b=m[0],y=m[1];Object(a.useEffect)((function(){u(o()),t&&f(t.uri||""),b&&y(null)}),[t]);var v,j,O,w=function(e){var n=e.target.getAttribute("name");if(n&&void 0!==l[n]&&t){var a=jt({},l,{},Ot({},n,e.target.value)),i=r.pageSave(t._id,{seo:a});!i||i instanceof Error||i.done((function(e){})).fail((function(){}))}};return i.a.createElement("form",null,i.a.createElement(c.g,{mt:"12px"},i.a.createElement(wt,{htmlFor:"title",_css:Object(h.themeGet)("colors.white"),_css2:Object(h.themeGet)("textStyles.small")},"Title"),i.a.createElement(c.s,{name:"title",id:"title",color:"white",placeholder:"Cover",translate:"no",maxLength:128,autoSize:!0,mt:"4px",defaultValue:l.title,onBlur:w})),i.a.createElement(c.g,{mt:"2px"},i.a.createElement(St,{htmlFor:"description",_css3:Object(h.themeGet)("colors.white"),_css4:Object(h.themeGet)("textStyles.small")},"Description"),i.a.createElement(c.s,{name:"description",id:"description",color:"white",placeholder:"What's it about...",translate:"no",maxLength:2048,autoSize:!0,mt:"4px",defaultValue:l.description,onBlur:w})),i.a.createElement(c.g,{mt:"2px"},i.a.createElement(Pt,{htmlFor:"keywords",_css5:Object(h.themeGet)("colors.white"),_css6:Object(h.themeGet)("textStyles.small")},"Keywords"),i.a.createElement(c.s,{name:"keywords",id:"keywords",color:"white",placeholder:"Design, fashion",translate:"no",spellCheck:!1,autoSize:!0,mt:"4px",defaultValue:l.keywords,onBlur:w})),i.a.createElement(c.g,{mt:"2px"},i.a.createElement(xt,{htmlFor:"link",_css7:Object(h.themeGet)("colors.white"),_css8:Object(h.themeGet)("textStyles.small")},(v=r.project,j=bt.a.readymag_host.split("//")[1],O=v.domain,v.user.domain||O||j)),i.a.createElement(c.n,{flexWrap:"wrap"},i.a.createElement(c.O,{color:"white",fontSize:"small"},function(e){var t=e.domain,n=e.user.domain,r=e.uri,a=e.user.uri;return n?"/"+r+"/":t?"/":"/"+a+"/"+r+"/"}(r.project)),i.a.createElement(c.r,{name:"link",id:"link",type:"text",color:"white",fontSize:"regular",spellCheck:!1,placeholder:t?"/".concat(t.num.toString()):"/",value:b||g,onKeyDown:function(e){y(null),13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){if(t){var r=/[^A-Za-z0-9_.+-]/g,a=e.currentTarget.value;r.test(a)&&(a=a.replace(r,""));var i=n.validatePageUri(t._id,a);if(i){var o={hyphen:"The link cannot begin or end with a hyphen",onlyNumbers:"The link cannot be numeric",uriLength:"The linkâs max length is 128 characters",used:"This link is already used",pageNotFound:"Can't found current page"}[Object.keys(i)[0]];y(o)}else f(a)}},onBlur:function(e){if(t&&!b){var n=e.currentTarget.value,a=r.pageSave(t._id,{uri:n});!a||a instanceof Error||a.done((function(e){f(e.uri||"")})).fail((function(){}))}}}))))})),_t=n("LDvm"),Ct=n("+9Qk");function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(n,!0).forEach((function(t){Tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nt(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Dt,Rt=Object(b.d)(c.h).withConfig({displayName:"SocialSettings__CustomizeButton"})(["width:100%;height:40px;border:solid 2px ",";border-radius:32px;"],Object(h.themeGet)("colors.darkGray"));!function(e){e.Default="default",e.Custom="custom",e.Inherited="inherited"}(Dt||(Dt={}));var At=Object(b.d)(c.g).withConfig({displayName:"SocialSettings___StyledBox"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);cursor:pointer;"]),Bt=Object(b.d)(c.g).withConfig({displayName:"SocialSettings___StyledBox2"})(["background-image:",";background-size:cover;background-repeat:no-repeat;"],(function(e){return e._css})),Lt=Object(b.d)(c.s).withConfig({displayName:"SocialSettings___StyledInlineTextArea"})(["&:disabled{opacity:0.4;}"]),Gt=Object(b.d)(c.s).withConfig({displayName:"SocialSettings___StyledInlineTextArea2"})(["&:disabled{opacity:0.4;}"]),Mt=b.d.label.withConfig({displayName:"SocialSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css2}),(function(e){return e._css3})),Ft=Object(b.d)(c.s).withConfig({displayName:"SocialSettings___StyledInlineTextArea3"})(["&:disabled{opacity:0.4;}"]),Vt=b.d.label.withConfig({displayName:"SocialSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css4}),(function(e){return e._css5})),Ut=i.a.memo((function(e){var t=e.currentPage,n=Object(a.useContext)(xn),r=new qe.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-custom-sharing",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"custom sharing"}),o=It(Object(a.useState)((function(){return!!window.RM.constructorRouter.me&&!!(window.RM.constructorRouter.me.get("permissions")||{}).custom_sharing})),1)[0],s=It(Object(a.useState)((function(){return n.project.master_share_pid||null})),2),l=s[0],u=s[1],d=function(e){var n=e||t;return n?l?l===n._id?Dt.Custom:Dt.Inherited:n.custom_shares?Dt.Custom:Dt.Default:Dt.Default},g=It(Object(a.useState)(d()),2),p=g[0],f=g[1],m=function(){return p===Dt.Default||p===Dt.Inherited},b=function(e){if(e.custom_shares){var t=e.custom_shares;if(!t.image){var n=T.default.screenshotSize(256),r=T.default.addFilenameComponent(e.screenshot,n);t.image=r}return t}return{description:"",title:"",tweet:"",image:""}},y=function(e){var r=e||t;if(!r)return null;var a=n.project.domain||n.project.user&&n.project.user.domain,i=Ct.a.getDefaultShare(r,n.project,{customDomain:Boolean(a)});if(l){if(l===r._id)return b(r);var o=n.pages.find((function(e){return e._id===l}));if(o)return b(o)}else if(r.custom_shares)return b(r);return i},j=It(Object(a.useState)((function(){return y()})),2),O=j[0],w=j[1];Object(a.useEffect)((function(){return w(y()),f(d()),function(){w(null)}}),[t]);var S=function(){if(t)return n.pageSave(t._id,{custom_shares:O})},P=It(Object(a.useState)(!1),2),x=P[0],E=P[1],_=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.size>bt.a.UPLOAD_IMAGE_SIZE_LIMIT)){e.next=3;break}return console.error(bt.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),e.abrupt("return");case 3:return E(!0),e.prev=4,e.next=7,Object(_t.o)("share-upload",t);case 7:(n=e.sent)&&n.picture&&n.picture.url&&O&&(w(zt({},O,{},{image:n.picture.url})),!(r=S())||r instanceof Error||r.done((function(){E(!1)})).fail((function(){}))),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:E(!1);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Nt(i,r,a,o,s,"next",e)}function s(e){Nt(i,r,a,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),C=function(e){var r=e.target.getAttribute("name");if(r&&void 0!==O[r]&&t){var a=zt({},O,{},Tt({},r,e.target.value)),i=n.pageSave(t._id,{custom_shares:a});!i||i instanceof Error||i.done((function(){})).fail((function(){}))}},k=function(){return Boolean(t&&l&&t._id===l)};return i.a.createElement("form",null,i.a.createElement(c.g,{mt:"12px",position:"relative"},i.a.createElement(c.O,{color:"white",textStyle:"small"},"OpenGraph"),i.a.createElement(c.g,{position:"absolute",right:0,top:0},i.a.createElement(v,{onClick:function(e){e.preventDefault()}}))),i.a.createElement(c.g,{width:192,height:104,mt:"12px"},i.a.createElement(c.m,{accept:"image/*",dropFile:!0,readFileData:!1,onChange:_,disabled:m()},i.a.createElement(At,{width:192,height:104,bg:"darkGrey",borderRadius:"s",position:"relative"},x&&i.a.createElement(c.g,{position:"absolute",top:"28px",left:"72px"},i.a.createElement(c.x,{size:"medium",bgColor:"transparent"})),i.a.createElement(Bt,{width:"100%",height:"100%",borderRadius:"s",_css:O&&O.image?"url(".concat(O.image,")"):"none"})))),i.a.createElement(c.g,null,i.a.createElement(Lt,{name:"title",id:"share-title",translate:"no",placeholder:"Title",maxLength:128,color:"white",textStyle:"small",mt:"4px",disabled:m(),defaultValue:O&&O.title?O.title:void 0,onBlur:C}),i.a.createElement(Gt,{name:"description",id:"share-description",translate:"no",maxLength:2048,autoSize:!0,color:"white",textStyle:"small",mt:"4px",disabled:m(),defaultValue:O&&O.description?O.description:void 0,onBlur:C})),i.a.createElement(c.g,{mt:"16px"},i.a.createElement(Mt,{htmlFor:"share-tweet",_css2:Object(h.themeGet)("colors.white"),_css3:Object(h.themeGet)("textStyles.small")},"Tweet message"),i.a.createElement(Ft,{name:"tweet",id:"share-tweet",translate:"no",maxLength:116,autoSize:!0,color:"white",textStyle:"small",disabled:m(),defaultValue:O&&O.tweet?O.tweet:void 0,onBlur:C})),i.a.createElement(c.n,{mt:"16px",alignItems:"center",justifyContent:"space-between"},i.a.createElement(c.g,{width:"128px"},i.a.createElement(Vt,{htmlFor:"all-pages",_css4:Object(h.themeGet)("colors.white"),_css5:Object(h.themeGet)("textStyles.small")},"Use these sharing settings for all pages")),i.a.createElement(c.N,{id:"all-pages",name:"all-pages",disabled:m()||!(!l||k()),checked:k(),onChange:function(e){t&&(e?(u(t._id),n.projectSave({master_share_pid:t._id})):(u(null),n.projectUnset("master_share_pid"),n.projectSave({})))}})),i.a.createElement(Rt,{textStyle:"small",color:"white",mt:"16px",display:p===Dt.Default?"block":"none",onClick:function(e){e.preventDefault(),t&&(o?(p!==Dt.Inherited&&f(Dt.Custom),S()):r.render())}},"Customize"),i.a.createElement(Rt,{textStyle:"small",color:"white",mt:"16px",display:p===Dt.Custom?"block":"none",onClick:function(e){if(e.preventDefault(),t){n.pageUnset(t._id,"custom_shares");var r=n.pageSave(t._id,{});l&&(n.projectUnset("master_share_pid"),n.projectSave({}),u(null)),!r||r instanceof Error||r.done((function(e){w(y(e)),f(d(e))})).fail((function(){}))}}},"Restore to defaults"),i.a.createElement(Rt,{textStyle:"small",color:"white",mt:"16px",display:p===Dt.Inherited?"block":"none",onClick:function(e){e.preventDefault(),l&&window.RM.constructorRouter.showWorkspace({id:l})}},"Go to master page"))})),Wt=4e3,Yt=n("EcEN");function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(n,!0).forEach((function(t){Qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Zt=b.d.button.withConfig({displayName:"Accordion__CollapseButton"})(["width:100%;box-sizing:border-box;padding:11px 0;border:0;outline:0;background:transparent;text-align:left;transition:color 200ms,border 200ms;"]),Kt=Object(b.d)(c.g).withConfig({displayName:"Accordion___StyledBox"})(["height:",";overflow:hidden;transition:height 300ms ease;"],(function(e){return e._css})),qt=function(e){var t=e.title,n=e.open,r=e.customClass,o=e.activeKey,s=e.containerHeight,l=e.count,u=e.onCollapseClick,d=e.children,g=Jt(Object(a.useState)(0),2),p=g[0],f=g[1],m=Jt(Object(a.useState)(0),2),h=m[0],b=m[1],y=Jt(Object(a.useState)(Object(Yt.v4)()),1)[0],v=Object(a.useCallback)((function(e){null!==e&&f(e.getBoundingClientRect().height)}),[]);Object(a.useEffect)((function(){s&&l&&b(s-l*p)}),[s]);var j,O=function(){return null===o&&n||o===y};return i.a.createElement(i.a.Fragment,null,i.a.createElement(Zt,{className:(j="collapse-btn "+(O()?"active":"inactive"),r&&(j+=" ".concat(r)),j),ref:v,onClick:function(){return u&&u(y)}},i.a.createElement(c.O,{textStyle:"subheading"},t)),i.a.createElement(Kt,{_css:O()?Number(h)+"px":"0px"},d))},$t=function(e){var t=e.children,n=Jt(Object(a.useState)({containerHeight:0,count:i.a.Children.count(t),activeKey:null}),2),r=n[0],o=n[1],s=Object(a.useCallback)((function(e){null!==e&&o(Xt({},r,{containerHeight:e.getBoundingClientRect().height}))}),[]),l=function(e){o(Xt({},r,{activeKey:e}))};return i.a.createElement(c.g,{width:"100%",height:"100%",ref:s},i.a.Children.map(t,(function(e){if(i.a.isValidElement(e)&&e.type===qt)return i.a.cloneElement(e,Xt({},r,{onCollapseClick:l}));throw new Error("Only Collapse elements can be children of Accordion")})))};function en(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var tn=b.d.div.withConfig({displayName:"PageSettings__PageSettingsSidebar"})(["height:100%;width:240px;padding:0;box-sizing:border-box;position:fixed;top:0;right:0;bottom:0;z-index:",";background-color:",";overflow-x:hidden;overflow-y:auto;transform:translateX( "," );transition:transform 300ms ease;.collapse-btn.active{color:",";}.collapse-btn.inactive{color:",";}.collapse-btn.devider{border-top:2px solid ",";}"],Wt,Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isPageSettingsOpened?"0":"240px":e.isPageSettingsOpened?"480px":"240px"}),Object(h.themeGet)("colors.white"),Object(h.themeGet)("colors.darkGray"),Object(h.themeGet)("colors.darkGray")),nn=function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(xn),n=en(Object(a.useState)(null),2),r=n[0],o=n[1];return Object(a.useEffect)((function(){var n=e.isPageSettingsOpened&&t.pages.find((function(t){return t.num===e.currentPageNum}))||null;return o(n),function(){o(null)}}),[e.isPageSettingsOpened,e.currentPageNum]),Object(a.useEffect)((function(){e.isPageSettingsOpened?document.body.classList.add("page-settings-is-opened"):document.body.classList.remove("page-settings-is-opened")}),[e.isPageSettingsOpened]),i.a.createElement(tn,{isPageSettingsOpened:e.isPageSettingsOpened,isSettingsOpened:e.isSettingsOpened},i.a.createElement(c.g,{height:"100%",mx:"24px"},i.a.createElement($t,null,i.a.createElement(qt,{title:"Page SEO",open:!0},i.a.createElement(Et,{currentPage:r})),i.a.createElement(qt,{title:"Social sharing",customClass:"devider"},i.a.createElement(Ut,{currentPage:r})))))};function rn(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return rn=function(){return e},e}function an(){return(an=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var on=i.a.createElement("path",{d:"M17.485.515a1 1 0 010 1.414L10.415 9l7.07 7.071a1 1 0 01-1.414 1.414L9 10.415l-7.071 7.07a1 1 0 01-1.414-1.414L7.585 9 .516 1.929A1 1 0 011.929.515L9 7.585l7.071-7.07a1 1 0 011.414 0z",fill:"#FFF",fillRule:"evenodd"}),sn=Object(b.d)((function(e){return i.a.createElement("svg",an({width:18,height:18},e),on)}))(rn(),h.color);function cn(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return cn=function(){return e},e}function ln(){return(ln=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var un=i.a.createElement("g",{stroke:"#FFF",strokeWidth:2,fill:"none",fillRule:"evenodd"},i.a.createElement("ellipse",{opacity:.9,cx:19,cy:13,rx:18,ry:12}),i.a.createElement("circle",{cx:19,cy:13,r:8})),dn=Object(b.d)((function(e){return i.a.createElement("svg",ln({width:38,height:26},e),un)}))(cn(),h.color),gn=Object(b.d)(c.g).withConfig({displayName:"Settings__SettingsSidebar"})(["font-family:",";transform:translateX( "," );transition:transform 300ms ease;"],Object(h.themeGet)("fonts.main"),(function(e){return e.isSettingsOpened?e.isTrashOpened||e.isPageSettingsOpened?"-240px":"0px":"240px"}));gn.defaultProps={blacklist:["isSettingsOpened","isTrashOpened","isPageSettingsOpened","height","position","top","right","zIndex"]};var pn=Object(b.d)(c.g).withConfig({displayName:"Settings__PreviewButtonWrap"})(["width:56px;height:56px;position:fixed;right:80px;bottom:16px;color:",";background-color:",";z-index:",";cursor:pointer;:hover{background-color:",";}transform:translateX( "," );transition:transform 300ms ease,background-color 200ms ease;"],Object(h.themeGet)("colors.white"),Object(h.themeGet)("colors.darkGray"),Wt,Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isTrashOpened||e.isPageSettingsOpened?"-480px":"-240px":"0px"}));pn.defaultProps={blacklist:["isSettingsOpened","isTrashOpened","isPageSettingsOpened","borderRadius"]};var fn=Object(b.d)(c.n).withConfig({displayName:"Settings__SettingsToogleWrap"})(["width:56px;height:56px;position:fixed;right:16px;bottom:16px;justify-content:center;color:",";background-color:",";text-align:center;z-index:",";cursor:pointer;:hover{background-color:",";}transform:translateX( "," );transition:transform 300ms ease,background-color 200ms ease;"],Object(h.themeGet)("colors.white"),Object(h.themeGet)("colors.darkGray"),Wt,Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isTrashOpened||e.isPageSettingsOpened?"-480px":"-240px":"0px"}));fn.defaultProps={blacklist:["isSettingsOpened","isTrashOpened","isPageSettingsOpened","borderRadius"]};var mn,hn=function(){var e=Object(a.useContext)(p);return i.a.createElement(pn,{borderRadius:"round",isSettingsOpened:e.isSettingsOpened,isTrashOpened:e.isTrashOpened,isPageSettingsOpened:e.isPageSettingsOpened,onClick:function(){return window.RM.views.toolbar.togglePreview()}},i.a.createElement(c.n,{width:"56px",height:"56px",borderRadius:"round",justifyContent:"center",alignItems:"center"},i.a.createElement(dn,null)))},bn=function(){var e=Object(a.useContext)(p);return i.a.createElement(fn,{borderRadius:"round",isSettingsOpened:e.isSettingsOpened,isTrashOpened:e.isTrashOpened,isPageSettingsOpened:e.isPageSettingsOpened,onClick:function(){return e.dispatch({type:r.ToggleSettingsSidebar})}},e.isSettingsOpened?i.a.createElement(c.g,{mt:"19px"},i.a.createElement(sn,null)):i.a.createElement(c.O,{textStyle:"subheading",lineHeight:"56px"},e.currentPageNum))},yn=Object(b.d)(c.g).withConfig({displayName:"Settings___StyledBox"})(["opacity:",";display:",";transition:opacity 300ms ease;"],(function(e){return e._css}),(function(e){return e._css2})),vn=function(e){var t=e.router,n=e.projectSettingsPanel,o=Object(a.useContext)(p),s=function(e){o.dispatch({type:r.SetCurrentPageNum,payload:e.getPageNum()})};return Object(a.useEffect)((function(){o.isSettingsOpened?document.body.classList.add("settings-is-shown"):document.body.classList.remove("settings-is-shown")}),[o.isSettingsOpened]),Object(a.useEffect)((function(){return t.on("pageChange",s),function(){t.off("pageChange",s)}}),[t]),i.a.createElement(i.a.Fragment,null,i.a.createElement(hn,null),i.a.createElement(bn,null),i.a.createElement(gn,{isSettingsOpened:o.isSettingsOpened,isTrashOpened:o.isTrashOpened,isPageSettingsOpened:o.isPageSettingsOpened,width:"240px",height:"100%",position:"fixed",top:"0",right:"0",bottom:"0",zIndex:Wt},i.a.createElement(c.g,{width:"240px",height:"100%",p:2,bg:"lightGray",color:"black"},i.a.createElement(c.g,{className:"page-drag-container",position:"absolute",top:"0",left:"0",width:"100%"}),i.a.createElement(x,{projectSettingsPanel:n}),i.a.createElement(Ke,null),i.a.createElement(rt,null)),i.a.createElement(yn,{width:"240px",height:"100%",position:"absolute",top:"0",bottom:"0",bg:"white",_css:o.isPageSettingsOpened?"0.6":"0",_css2:o.isPageSettingsOpened?"block":"none"})),i.a.createElement(ht,null),i.a.createElement(nn,null))};function jn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function On(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?On(n,!0).forEach((function(t){Sn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):On(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){e.After="after",e.Before="before",e.Inside="inside"}(mn||(mn={}));var xn=i.a.createContext({}),En=function e(t,n){var r=[];for(var a in t)if(t[a].parentPage===n){var i=e(t,t[a]._id),o=Object.assign({},t[a]);i.length&&(o.children=i),r.push(o)}else if(void 0===t[a].parentPage){var s=Object.assign({},t[a]);r.push(s)}return r},_n=function(e,t){var n={};return e.forEach((function(e){n[e._id]={collapsed:!0,children:e.children?e.children.map((function(e){return e._id})):[]}})),Object.keys(t).forEach((function(e){n[e]&&(n[e].collapsed=t[e].collapsed)})),n},Cn=function(e){var t=e.project,n=e.router,r=e.children,o=Pn(Object(a.useState)(null),2),s=o[0],c=o[1];Object(a.useEffect)((function(){var e=document.querySelector(".settings-container");e&&c(e)}),[]);var l=new qe.default({$parent:document.querySelector("body > .popups"),router:n,opts:{type:"type-more-pages",is_contributor:!n.isOwner,owner_email:t.get("user")?t.get("user").email:""},alert_source:"custom sharing"}),u={projectSet:function(e,n){return t.set(e,n)},projectUnset:function(e,n){return t.unset(e,n)},projectSave:function(e,n){return t.save(e,n)},pageSet:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.set(n,r)},pageUnset:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.unset(n,r)},pageSave:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.save(n,r)},setPageCollapse:function(e,t){h((function(n){return wn({},n,{pagesParams:wn({},n.pagesParams,{},Sn({},e,wn({},n.pagesParams[e],{collapsed:t})))})}))},addNewPage:function(e){return new Promise((function(r,a){var i=m(e,f.pages,f.pagesTree,f.pagesParams),o=i.newPageNum,s=i.newPageParentId;t.addPage({num:o},(function(e){if(e&&e.err)a(e);else{var i=e;i.isEmptyPage=!0,i.set("parentPage",s),n.pageOrder.reorderPagesAfterAdd({page:i,magId:t.get("_id")}),t.onAdd(i),n.showWorkspace({id:i.id}),t.getPage(i.id).requestNewScreenshot((function(){n.trigger("renewScreenshot",i.id)})),g(i.id),r(i)}}),!0)}))},duplicatePage:function(e){return new Promise((function(r,a){var i=t.getPage(e);if(!i)return a(new Error("Could not find page"));i.get("mid")||i.save({mid:t.get("_id")},{silent:!0});var o=m(i.get("num"),f.pages,f.pagesTree,f.pagesParams),s=o.newPageNum,c=o.newPageParentId;i.duplicate((function(e){if(e instanceof Error)return"Server error: permission_denied"===e.message&&l.render(),a(e);var i=e;i.set("parentPage",c),n.pageOrder.reorderPagesAfterAdd({page:i,magId:t.get("_id")}),t.onAdd(i),n.gg.guides.model&&(n.gg.guides.model.addPage(i.id,{silent:n.gg.guides.hidden}),n.gg.guides.model.save()),n.showWorkspace({id:i.id}),g(i.id),r(e)}),{num:s})}))},getNewPageOrderElement:function(e){var n=e.changingId,r=e.targetId,a=e.position,i=t.getPage(r),o=f.pagesParams[r],s={id:n,num:1,parentPage:null};if(a===mn.Inside){if(!o)return new Error("insert into child element");s.num=i.get("num")+1,s.parentPage=r}else a===mn.Before?(s.parentPage=o?null:i.get("parentPage")||null,s.num=i.get("num")):o&&o.children.length?o.collapsed?(s.num=i.get("num")+1,s.parentPage=r):(s.num=i.get("num")+o.children.length+1,s.parentPage=null):(s.parentPage=o?null:i.get("parentPage")||null,s.num=i.get("num")+1);return s},reorderPage:function(e,r){return new Promise((function(a,i){var o=t.getPage(e);if(o.get("num")===r.num&&o.get("parentPage")===r.parentPage)return a();var s=f.pagesParams[e],c=0;s&&s.children.length&&(c=s&&s.children.length),c&&(s.collapsed?n.pageOrder.removeParentIds(s.children):r.parentPage&&n.pageOrder.updateParentIds(s.children,r.parentPage)),n.pageOrder.reorderAfterDrag(o.get("num"),c,r,t.get("_id")),t.trigger("change:pids",t,t.get("pids")),a()}))},deletePage:function(e){return new Promise((function(r,a){if(n.isPageLocked(e))return a(new Error("This page is locked"));if(1===t.get("pids").length)return a(new Error("Can't delete last page"));var i=t.getPage(e),o=i.get("num"),s=n.workspace.getPageNum()===o,c=f.pagesParams[e],l=[];if(c){var u=f.pagesTree.find((function(t){return t._id===e})),g=[];u&&u.children&&u.children.length&&(g=u.children.map((function(e){return e._id}))),c.collapsed?n.pageOrder.removeParentIds(g):l=jn(g)}l.push(i.get("_id")),n.pageOrder.deletePagesFromOrder(l,t.get("_id")),t.deletePages(l,(function(e){e&&e instanceof Error&&(n.pageOrder.load(t),a(e)),s&&d(o),n.removeWorkspace(i.id),r()}))}))},restorePage:function(e){return new Promise((function(r,a){t.restorePage(e,{success:function(e){var a=m(n.workspace.getPageNum(),f.pages,f.pagesTree,f.pagesParams),i=a.newPageNum,o=a.newPageParentId;e.set("num",i),e.set("parentPage",o),n.pageOrder.reorderPagesAfterAdd({page:e,magId:t.get("_id")}),t.onAdd(e),t.save(),n.showWorkspace({id:e.id}),g(e.id),r(e)},error:function(e){var t=JSON.parse(e.responseText);"permission_denied"===t.err&&l.render(),a(t)}},!0)}))},deletePagesFromTrash:function(e){return t.deleteTrashPages(e)},updateTrash:function(){return new Promise((function(e,n){t.get("has_deleted_pages")?t.fetchTrashPages().then((function(t){t&&h((function(e){return wn({},e,{trashPages:t})})),e(t)})):e([])}))},emptyTrash:function(){return t.emptyTrash().then((function(){h((function(e){return wn({},e,{trashPages:[]})}))}))}},d=function(e){var t=n.pageOrder.get("order"),r=null;if(e>t.length)r=t[t.length-1].id;else{var a=t.find((function(t){return t.num===e}));a&&(r=a.id)}r?(n.showWorkspace({id:r}),g(r)):n.showWorkspace({num:1})},g=function(e){if(s){var t=s.querySelector('.page-list-draggable-item[data-page-id="'.concat(e,'"]'));t&&t.scrollIntoView({behavior:"smooth"})}},p=Pn(Object(a.useState)((function(){var e=t.pages.models.map((function(e){return e.attributes}));e.sort((function(e,t){return e.num-t.num}));var r=En(e,null);return{project:t.attributes,isOwner:!!n.isOwner,pages:e,trashPages:[],pagesTree:r,pagesParams:_n(r,{})}})),2),f=p[0],h=p[1],b=function(e,t){e&&h((function(n){var r=e.pages.models.map((function(e){return e.attributes})).filter((function(e){return t.includes(e._id)}));r.sort((function(e,t){return e.num-t.num}));var a=En(r,null);return wn({},n,{project:e.attributes,pages:r,pagesTree:a,pagesParams:_n(a,n.pagesParams)})}))},y=function(e){e&&(e.changed&&e.changed.pids||h((function(t){return wn({},t,{project:e.attributes})})))},v=function(e){e&&(e.changed&&(e.changed.num||e.changed.parentPage)||h((function(t){var n=j(e,t.pages);n.sort((function(e,t){return e.num-t.num}));var r=En(n,null);return wn({},t,{pages:n,pagesTree:r,pagesParams:_n(r,t.pagesParams)})})))},j=function(e,t){var n=f.pages.findIndex((function(t){return t._id===e.get("_id")}));return n>=0?f.pages.map((function(t,r){return r===n?e.attributes:t})).sort((function(e,t){return e.num-t.num})):t},O=function(e){e&&h((function(t){var n=Array.from(t.trashPages);return n.push(e.attributes),wn({},t,{trashPages:n})}))},w=function(e){e&&h((function(t){var n=Array.from(t.trashPages),r=n.findIndex((function(t){return t._id===e.get("_id")}));return r>-1&&n.splice(r,1),wn({},t,{trashPages:n})}))};return Object(a.useEffect)((function(){return t.on("change",y),t.on("change:pids",b),t.pages.on("change",v),t.trashPages.on("add",O),t.trashPages.on("remove",w),function(){t.off("change",y),t.off("change:pids",b),t.pages.off("change",v),t.trashPages.off("add",O),t.trashPages.off("remove",w)}}),[t]),i.a.createElement(xn.Provider,{value:wn({},f,{},u)},r)},kn=function(e){var t=e.model,n=e.router,r=e.children;return i.a.createElement(Cn,{project:t,router:n},i.a.createElement(f,{magModel:t,router:n},r))},zn=function(e){var t=e.model,n=e.domElement,r=e.router,a=e.projectSettingsPanel;s.a.render(i.a.createElement(c.P,null,i.a.createElement(kn,{model:t,router:r},i.a.createElement(vn,{projectSettingsPanel:a,router:r}))),n)};n.d(t,"ReorderPagePosition",(function(){return mn})),n.d(t,"ProjectContext",(function(){return xn})),n.d(t,"ProjectContextProvider",(function(){return Cn})),n.d(t,"SettingsController",(function(){return kn})),n.d(t,"renderSettings",(function(){return zn})),n.d(t,"SettingsActionTypes",(function(){return r})),n.d(t,"SettingsContext",(function(){return p})),n.d(t,"CreateSettingsContextProvider",(function(){return f}))}}]);